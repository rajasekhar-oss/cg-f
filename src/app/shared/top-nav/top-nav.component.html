<div class="top-nav">
  <app-error-notification *ngIf="showError" [message]="errorMessage" (closed)="onErrorClosed()"></app-error-notification>
  <div class="top-nav-content">
    <div class="top-nav-left">
      <h1 class="top-nav-title" (click)="navigate('/')" style="cursor:pointer;">CardGame</h1>
    </div>
    <div class="top-nav-right">
      <div class="top-nav-items">
        <button 
          *ngFor="let item of topNavItems"
          (click)="navigate(item.route)"
          [class.active]="isActiveRoute(item.route)">
          {{ item.label }}
        </button>
      </div>
      <div class="top-nav-game-request-wrapper" style="position:relative;">
        <button class="top-nav-notification-btn" (click)="toggleDropdown()">
          ðŸŽ®
          <span class="top-nav-notification-badge" *ngIf="requestCount > 0">{{ requestCount }}</span>
        </button>
        <div class="game-request-dropdown" *ngIf="showDropdown" style="position:absolute; right:0; top:40px; min-width:260px; z-index:100;">
          <div *ngIf="requestCount === 0" style="padding:16px; color:var(--text-4); text-align:center;">No game requests</div>
          <div *ngFor="let req of requests" class="game-request-item">
            <img *ngIf="req.imageUrl" [src]="req.imageUrl" alt="profile" style="width:36px; height:36px; border-radius:50%; object-fit:cover; border:1px solid var(--border-1);" />
            <div *ngIf="!req.imageUrl" style="width:36px; height:36px; border-radius:50%; background:var(--bg-4); display:flex; align-items:center; justify-content:center; font-weight:700; color:var(--blue-1);">
              {{ req.username ? req.username.charAt(0).toUpperCase() : '?' }}
            </div>
            <div style="flex:1;">
              <div style="font-weight:600; color:var(--text-1);">{{ req.username }}</div>
            </div>
            <button (click)="joinGame(req)" style="background:var(--btn-primary-bg); color:var(--btn-primary-text); border:none; border-radius:6px; padding:6px 12px; font-size:14px; cursor:pointer;">Join Game</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
